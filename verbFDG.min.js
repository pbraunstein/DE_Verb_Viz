function vizIt(){var t=document.getElementById("menu"),e=document.createElement("select");e.id="options",t.appendChild(e),data.sort(function(t,e){var n=amerikanize(t.root.toLowerCase()),r=amerikanize(e.root.toLowerCase());return r>n?-1:1});var n=0;for(index=null,n=0;n<data.length;n++){var r=document.createElement("option");r.value=data[n],r.text=data[n].root,e.appendChild(r),0==data[n].root.localeCompare("sprechen")&&(e.selectedIndex=n)}e.onchange=function(){buildFDG(data[e.selectedIndex])},buildFDG(data[e.selectedIndex])}function amerikanize(t){return t=t.replace("ä","ae"),t=t.replace("ü","ue"),t=t.replace("ö","oe"),t=t.replace("ß","ss")}function buildFDG(t){for(fdg&&(svg.selectAll(".node").remove(),svg.selectAll(".link").remove()),fdg=d3.layout.force().gravity(.05).charge(-1e3).size([width,height]),nodes=[],i=1,rootLength=t.root.length,nodes.push({name:t.root,group:i++,hub:!0,trans:t.trans}),t.childWords.forEach(function(t){nodes.push({name:t.verb,group:i++,hub:!1,trans:t.trans})}),links=[],i=1;i<nodes.length;i++){var e={source:0,target:i,value:6};e.separ=t.childWords[i-1].separ,links.push(e)}fdg.nodes(nodes).links(links).linkDistance(function(t){return t.separ?300:150}).start();var n=svg.selectAll(".link").data(links).enter().append("line").attr("class","link").style("stroke-dasharray",function(t){return t.separ?10:0}).style("stroke-width",function(t){return t.separ?Math.sqrt(t.value):t.value}),r=svg.selectAll(".node").data(nodes).enter().append("g").attr("class","node").call(fdg.drag);r.append("circle").attr("r",function(t){return t.hub?HUB_SCALE_FACTOR*nodeRad:nodeRad}).style("fill",function(t){return color(t.group)}),r.append("text").attr("text-anchor","middle").attr("dy",".35em").style("fill","gray").style("stroke","black").text(function(t){return t.hub?t.name:t.name.slice(0,-rootLength)}),r.append("title").text(function(t){return t.name+"\n"+t.trans}),r.on("click",clickEventHandler),fdg.on("tick",function(){adjustNodesNLinks(r,n)})}function clickEventHandler(t){fdg.start();var e=d3.select(this).select("text").text();d3.select(this).select("circle").transition().duration(TRANS_DURATION).attr("r",2*d3.select(this).select("circle").attr("r")).style("opacity",.3).each("start",function(){d3.select(this).style("pointer-events","none")}),d3.select(this).select("text").transition().delay(TRANS_DURATION).text(t.trans),d3.select(this).select("text").transition().delay(PAUSE_DURATION).text(e),d3.select(this).select("circle").transition().delay(PAUSE_DURATION).duration(TRANS_DURATION).attr("r",d3.select(this).select("circle").attr("r")).style("opacity",1).each("end",function(){d3.select(this).style("pointer-events","auto")})}function adjustNodesNLinks(t,e){t.attr("transform",function(t){return"translate("+clampX(t,this)+","+clampY(t,this)+")"}),e.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}function clampX(t,e){var n,r=d3.select(e)[0][0].childNodes[0].r.animVal.value;return n=t.x-r<0?r:t.x+r>width?width-r:t.x,t.x=n,t.x}function clampY(t,e){var n,r=d3.select(e)[0][0].childNodes[0].r.animVal.value;return n=t.y-r<0?r:t.y+r>height?height-r:t.y,t.y=n,t.y}function getRandomPos(t){Math.floor(t?Math.random()*width:Math.random()*height)}var color=d3.scale.category20(),data,width=700,height=700,nodeRad=30,HUB_SCALE_FACTOR=2,TRANS_DURATION=1e3,PAUSE_DURATION=3e3,svg=d3.selectAll("div").select(function(){return"viz"==this.id?this:void 0}).append("svg").attr("width",width).attr("height",height),fdg;svg.append("rect").attr("x",0).attr("y",0).attr("width",width).attr("height",height).style("fill","white").style("stroke","black");